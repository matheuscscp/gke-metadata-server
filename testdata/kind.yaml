# Copyright 2025 Matheus Pimenta.
# SPDX-License-Identifier: AGPL-3.0

apiVersion: kind.x-k8s.io/v1alpha4
kind: Cluster
nodes:
- role: control-plane
- role: worker
  labels:
    iam.gke.io/gke-metadata-server-enabled: "true"
    node.gke-metadata-server.matheuscscp.io/routingMode: eBPF
    node.gke-metadata-server.matheuscscp.io/serviceAccountName: test-impersonated
    node.gke-metadata-server.matheuscscp.io/serviceAccountNamespace: default
    hasRoutingMode: "true"
    hasServiceAccount: "true"
- role: worker
  labels:
    iam.gke.io/gke-metadata-server-enabled: "true"
    node.gke-metadata-server.matheuscscp.io/routingMode: Loopback
    hasRoutingMode: "true"
    hasServiceAccount: "false"
- role: worker
  labels:
    iam.gke.io/gke-metadata-server-enabled: "true"
    node.gke-metadata-server.matheuscscp.io/routingMode: None
    hasRoutingMode: "false"
    hasServiceAccount: "false"
networking:
  disableDefaultCNI: true
